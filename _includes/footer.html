<!-- The Footer -->

<footer
  aria-label="Site Info"
  class="
    d-flex flex-column justify-content-center text-muted
    flex-lg-row justify-content-lg-between align-items-lg-center pb-lg-3
  "
>
  <div class="container">
  <p class="text-center text-muted">
    {{- '©' }}
    <time>{{ 'now' | date: '%Y' }}</time>

    {% if site.social.links %}
      <a href="{{ site.social.links[0] }}">{{ site.social.name }}</a>.
    {% else %}
      <em class="fst-normal">{{ site.social.name }}</em>.
    {% endif %}

    {% if site.data.locales[include.lang].copyright.brief %}
      <span
        data-bs-toggle="tooltip"
        data-bs-placement="top"
        title="{{ site.data.locales[include.lang].copyright.verbose }}"
      >
        {{- site.data.locales[include.lang].copyright.brief -}}
      </span>
    {% endif %}
  </p>
  </div>


  <!-- 【中文目录修复脚本 - 偏移量微调版】 -->
<script>
(function() {
  // --- 配置区域 ---
  // 导航栏的高度 (Chirpy 约为 56px)
  var NAVBAR_HEIGHT = 56;
  
  // 额外的留白间距 (如果你觉得太靠下，把这个数字改小，甚至可以由正数改为负数)
  // 当前设置：10 (比之前少了 10px，会让标题往上提)
  var SPACE = 10; 
  
  // 最终的偏移量
  var FINAL_OFFSET = NAVBAR_HEIGHT + SPACE;
  // ----------------

  console.log(">>> TOC Fix: Loaded. Offset set to:", FINAL_OFFSET);

  function fixClick(e) {
    var link = e.target.closest('a');
    if (!link) return;
    var href = link.getAttribute('href');
    if (!href || !href.startsWith('#')) return;

    e.preventDefault();

    var targetId = decodeURIComponent(href.substring(1));
    var targetEl = document.getElementById(targetId);
    if (!targetEl) targetEl = document.getElementsByName(targetId)[0];

    if (targetEl) {
      // 计算滚动位置
      var top = targetEl.getBoundingClientRect().top + window.scrollY - FINAL_OFFSET;

      window.scrollTo({ top: top, behavior: 'smooth' });
      history.pushState(null, null, href);
    }
  }

  // 轮询等待 tocbot
  var checkInterval = setInterval(function() {
    var toc = document.querySelector('#toc');
    if (window.tocbot && toc && toc.querySelector('a')) {
      clearInterval(checkInterval);
      
      tocbot.refresh({
        tocSelector: '#toc',
        contentSelector: '.content',
        headingSelector: 'h2, h3, h4',
        ignoreSelector: '[data-toc-skip]',
        orderedList: false,
        // 这里也要设置感应区，建议比上面的 FINAL_OFFSET 稍微大一点点，保证高亮准确
        headingsOffset: FINAL_OFFSET + 10, 
        scrollSmooth: false, 
        onClick: fixClick 
      });
    }
  }, 100);
})();
</script>
  
  <!--APlayer-->
  <script src="https://cdn.jsdelivr.net/npm/vconsole/dist/vconsole.min.js"></script>
  <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/aplayer@1.10.1/dist/APlayer.min.css">
  <script src="https://cdn.jsdelivr.net/npm/hls.js/dist/hls.min.js"></script>
  <script src="https://cdn.jsdelivr.net/npm/aplayer@1.10.1/dist/APlayer.min.js"></script>
  <script src="https://cdn.jsdelivr.net/npm/color-thief-don@2.0.2/src/color-thief.js"></script>
  <script src="https://cdn.jsdelivr.net/npm/meting@2.0.1/dist/Meting.min.js"></script>
  <meting-js 
    server="tencent" 
    type="playlist" 
    id="9641150678" 
    autoplay="false" 
    fixed="true"
    loop="one"
    volume="0.5">
  </meting-js>
</footer>
